import{k as w,h as f,B as x,c as r,a as b,o,b as d,d as e,g as E,t as l,F as h,C as p,w as C,i as k,v as A,e as S,D}from"./vendor.53f5f295.js";import{b as u,A as i,_ as j,e as _,P as m,l as v,c as B}from"./index.bcea53cf.js";class I{async addAttendee(a){const s=await u.post("api/attendees",a);console.log("attending",s.data),i.attendees=s.data}async removeAttendee(a){const s=await u.delete(`api/attendees/${a}`);console.log("unattending",s.data),i.attendees.filter(t=>t.id!==a)}}const M=new I;const N={setup(){const c=w(),a=f({});return x(async()=>{try{await _.getEventById(c.params.id),await _.getEventComments(c.params.id),await _.getEventAttendees(c.params.id)}catch(s){m.toast(s.message,"error"),v.error(s)}}),{route:c,editable:a,event:r(()=>i.activeEvent),account:r(()=>i.account),attendees:r(()=>i.attendees),comments:r(()=>i.comments),isAttending:r(()=>i.attendees.find(s=>s.accountId==i.account.id)),async cancelEvent(){if(m.confirm("Are you sure you would like to cancel this event?"))try{await _.cancelEvent(c.params.id)}catch(s){m.toast(s.message,"error"),v.error(s)}},async createComment(){try{await B.createComment(c.params.id,a.value),a.value={}}catch(s){m.toast(s.message,"error"),v.error(s),v.error(s)}},async addAttendee(){try{let s={eventId:c.params.id};await M.addAttendee(s)}catch(s){m.toast(s.message,"error"),v.error(s)}}}}},V={class:"row justify-content-center mt-3"},L={class:"col-12 p-4"},P={class:"card banner mb-3"},F={class:"row g-0 elevation-4"},T={class:"col-md-4 my-4 p-3 pt-4"},q=["src","alt"],J={class:"col-md-8"},O={class:"card-body"},R={key:0,class:"dropdown"},U=e("div",{class:"dropdown-toggle selectable text-end","data-bs-toggle":"dropdown","aria-expanded":"false",id:"eventDropdown",title:"edit or delete event"},[e("span",{class:"mx-3 text-white display-3"},"...")],-1),z={class:"dropdown-menu p-0","aria-labelledby":"eventDropdown"},G=e("div",{class:"hoverable selectable","data-bs-toggle":"modal","data-bs-target":"#edit-event-modal"}," Edit Event ",-1),H={class:"card-title text-uppercase text-white text-shadow fw-bolder"},K={class:"card-text text-white text-shadow fs-4"},Q={class:"card-text text-white text-shadow fs-4"},W={class:"card-text text-white text-shadow"},X={key:1,class:"d-flex justify-content-between bottom pt-4"},Y={class:"fs-2 text-white text-shadow"},Z=["aria-label"],$=["aria-label"],ee=["aria-label"],te={key:2},se=e("p",{class:"fs-1 text-center text-danger fw-bold bg-dark"}," EVENT IS CANCELLED ",-1),ae=[se],ne={class:"row my-4"},oe={class:"col-12 px-4"},de={class:"card bg-dark"},ce=e("p",null,"Attending:",-1),ie={class:"d-flex"},re={class:"d-flex"},le=["title","src"],me={class:"row mt-5 pt-4 justify-content-center"},ve={class:"col-md-10"},_e={class:"card"},he={class:"form-group mt-3"},be=e("label",{for:"inputComment",class:"text-end"},"Join the conversation...",-1),pe=["aria-label"],ue=e("div",{class:"col-12 d-flex justify-content-end pt-2"},[e("button",{class:"btn btn-success"},"Create")],-1);function ge(c,a,s,t,ye,we){const g=b("Comment"),y=b("EditEventModal");return o(),d(h,null,[e("div",V,[e("div",L,[e("div",P,[e("div",F,[e("div",T,[e("img",{src:t.event.coverImg,class:"img-fluid rounded",alt:t.event.name+" image"},null,8,q)]),e("div",J,[e("div",O,[t.event.creatorId===t.account.id?(o(),d("div",R,[U,e("div",z,[G,e("div",{class:"hoverable selectable text-danger",onClick:a[0]||(a[0]=n=>t.cancelEvent())}," Cancel Event ")])])):E("",!0),e("h2",H,l(t.event.name),1),e("p",K,l(t.event.location),1),e("p",Q,l(new Date(t.event.startDate).toLocaleString()),1),e("p",W,l(t.event.description),1),t.event.isCanceled?(o(),d("div",te,ae)):(o(),d("div",X,[e("p",Y," Capacity: "+l(t.event.capacity),1),t.event.capacity==0?(o(),d("button",{key:0,class:"btn btn-info col-3 disabled","aria-label":"attend "+t.event.name}," Event is Sold Out ",8,Z)):t.isAttending?(o(),d("button",{key:1,class:"btn btn-success col-3 disabled","aria-label":"attend "+t.event.name}," Enjoy the Show! ",8,$)):(o(),d("button",{key:2,class:"btn btn-success col-3",onClick:a[1]||(a[1]=n=>t.addAttendee()),"aria-label":"attend "+t.event.name}," Attend Event ",8,ee))]))])])])])])]),e("div",ne,[e("div",oe,[e("div",de,[ce,e("div",ie,[(o(!0),d(h,null,p(t.attendees,n=>(o(),d("div",{key:n.id,class:"p-1"},[e("p",re,[e("img",{class:"user-img",title:n.account.name,src:n.account.picture},null,8,le)])]))),128))])])])]),e("div",me,[e("div",ve,[e("div",_e,[e("form",{onSubmit:a[3]||(a[3]=C(n=>t.createComment(),["prevent"])),class:"p-3"},[e("div",he,[be,k(e("textarea",{placeholder:"...",type:"text",class:"form-control",name:"inputComment",id:"inputComment",rows:"5","aria-label":"create comment for "+t.event.name,"onUpdate:modelValue":a[2]||(a[2]=n=>t.editable.body=n),required:""},null,8,pe),[[A,t.editable.body]])]),ue],32),e("div",null,[(o(!0),d(h,null,p(t.comments,n=>(o(),D(g,{key:n,comment:n},null,8,["comment"]))),128))])])])]),S(y,{id:"edit-event-modal"})],64)}var Ee=j(N,[["render",ge]]);export{Ee as default};
