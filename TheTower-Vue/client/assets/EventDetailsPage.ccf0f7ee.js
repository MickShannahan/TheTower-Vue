import{a as p,o as d,b as c,d as e,g as E,t as l,F as h,D as u,w as C,i as k,v as A,e as S,k as D,h as j,C as I,c as r,G as V,E as B}from"./vendor.d4444e46.js";import{b as g,A as i,_ as M,e as m,s as N,P as _,l as v,c as L}from"./index.5c51428f.js";class P{async addAttendee(a){const s=await g.post("api/attendees",a);console.log("attending",s.data),i.attendees=s.data}async removeAttendee(a){const s=await g.delete(`api/attendees/${a}`);console.log("unattending",s.data),i.attendees.filter(t=>t.id!==a)}}const F=new P;const b={setup(){const n=D(),a=j({});return I(async()=>{try{await m.getEventById(n.params.id),await m.getEventComments(n.params.id),await m.getEventAttendees(n.params.id),N.joinRoom(`event-${i.activeEvent.id}`)}catch(s){_.toast(s.message,"error"),v.error(s)}}),{route:n,editable:a,event:r(()=>i.activeEvent),account:r(()=>i.account),attendees:r(()=>i.attendees),comments:r(()=>i.comments),isAttending:r(()=>i.attendees.find(s=>s.accountId==i.account.id)),bgImage:r(()=>`url(${i.activeEvent.coverImg})`),async cancelEvent(){if(_.confirm("Are you sure you would like to cancel this event?"))try{await m.cancelEvent(n.params.id)}catch(s){_.toast(s.message,"error"),v.error(s)}},async createComment(){try{await L.createComment(n.params.id,a.value),a.value={}}catch(s){_.toast(s.message,"error"),v.error(s),v.error(s)}},async addAttendee(){try{let s={eventId:n.params.id};await F.addAttendee(s)}catch(s){_.toast(s.message,"error"),v.error(s)}}}}},y=()=>{V(n=>({"5e7742bc":n.bgImage}))},w=b.setup;b.setup=w?(n,a)=>(y(),w(n,a)):y;const R=b,T={class:"row justify-content-center mt-3"},q={class:"col-11 p-0 banner elevation-4"},G={class:"blur h-100"},J={class:"row g-0 p-1"},O={class:"col-md-4 my-4 p-3 pt-4"},U=["src","alt"],z={class:"col-md-8"},H={class:"card-body"},K={key:0,class:"dropdown"},Q=e("div",{class:"dropdown-toggle selectable text-end","data-bs-toggle":"dropdown","aria-expanded":"false",id:"eventDropdown",title:"edit or delete event"},[e("span",{class:"mx-3 text-white display-3"},"...")],-1),W={class:"dropdown-menu p-0","aria-labelledby":"eventDropdown"},X=e("div",{class:"hoverable selectable","data-bs-toggle":"modal","data-bs-target":"#edit-event-modal"}," Edit Event ",-1),Y={class:"card-title text-uppercase text-white text-shadow fw-bolder"},Z={class:"card-text text-white text-shadow fs-4"},$={class:"card-text text-white text-shadow fs-4"},ee={class:"card-text text-white text-shadow"},te={key:1,class:"d-flex justify-content-between bottom pt-4"},se={class:"fs-2 text-white text-shadow"},ae=["aria-label"],ne=["aria-label"],oe=["aria-label"],de={key:2},ce=e("p",{class:"fs-1 text-center text-danger fw-bold bg-dark"}," EVENT IS CANCELLED ",-1),ie=[ce],re={class:"row my-4"},le={class:"col-12 px-4"},_e={class:"card bg-primary p-2 darken-10 elevation-2"},ve=e("p",null,"Attending:",-1),me={class:"d-flex"},he={class:"d-flex"},be=["title","src"],pe={class:"row mt-5 pt-4 justify-content-center"},ue={class:"col-md-10"},ge={class:"card"},ye={class:"form-group mt-3"},we=e("label",{for:"inputComment",class:"text-end"},"Join the conversation...",-1),fe=["aria-label"],xe=e("div",{class:"col-12 d-flex justify-content-end pt-2"},[e("button",{class:"btn btn-success"},"Create")],-1);function Ee(n,a,s,t,Ce,ke){const f=p("Comment"),x=p("EditEventModal");return d(),c(h,null,[e("div",T,[e("div",q,[e("div",G,[e("div",J,[e("div",O,[e("img",{src:t.event.coverImg,class:"img-fluid rounded",alt:t.event.name+" image"},null,8,U)]),e("div",z,[e("div",H,[t.event.creatorId===t.account.id?(d(),c("div",K,[Q,e("div",W,[X,e("div",{class:"hoverable selectable text-danger",onClick:a[0]||(a[0]=o=>t.cancelEvent())}," Cancel Event ")])])):E("",!0),e("h2",Y,l(t.event.name),1),e("p",Z,l(t.event.location),1),e("p",$,l(new Date(t.event.startDate).toLocaleString()),1),e("p",ee,l(t.event.description),1),t.event.isCanceled?(d(),c("div",de,ie)):(d(),c("div",te,[e("p",se," Capacity: "+l(t.event.capacity),1),t.event.capacity==0?(d(),c("button",{key:0,class:"btn btn-info col-3 disabled","aria-label":"attend "+t.event.name}," Event is Sold Out ",8,ae)):t.isAttending?(d(),c("button",{key:1,class:"btn btn-success col-3 disabled","aria-label":"attend "+t.event.name}," Enjoy the Show! ",8,ne)):(d(),c("button",{key:2,class:"btn btn-success col-3",onClick:a[1]||(a[1]=o=>t.addAttendee()),"aria-label":"attend "+t.event.name}," Attend Event ",8,oe))]))])])])])])]),e("div",re,[e("div",le,[e("div",_e,[ve,e("div",me,[(d(!0),c(h,null,u(t.attendees,o=>(d(),c("div",{key:o.id,class:"p-1"},[e("p",he,[e("img",{class:"user-img",title:o.account.name,src:o.account.picture},null,8,be)])]))),128))])])])]),e("div",pe,[e("div",ue,[e("div",ge,[e("form",{onSubmit:a[3]||(a[3]=C(o=>t.createComment(),["prevent"])),class:"p-3"},[e("div",ye,[we,k(e("textarea",{placeholder:"...",type:"text",class:"form-control",name:"inputComment",id:"inputComment",rows:"5","aria-label":"create comment for "+t.event.name,"onUpdate:modelValue":a[2]||(a[2]=o=>t.editable.body=o),required:""},null,8,fe),[[A,t.editable.body]])]),xe],32),e("div",null,[(d(!0),c(h,null,u(t.comments,o=>(d(),B(f,{key:o,comment:o},null,8,["comment"]))),128))])])])]),S(x,{id:"edit-event-modal"})],64)}var De=M(R,[["render",Ee]]);export{De as default};
